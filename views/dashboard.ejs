<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Dashboard</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.1/font/bootstrap-icons.css" rel="stylesheet">
  <style>
    body { min-height: 100vh; overflow-x: hidden; }
    .sidebar { min-width: 220px; max-width: 220px; background-color: #343a40; min-height: 100vh; color: white; }
    .sidebar a { color: white; text-decoration: none; }
    .sidebar a.active { background-color: #495057; }
    .sidebar a:hover { background-color: #495057; }
    .content { margin-left: 220px; padding: 20px; }
  </style>
</head>
<body>
  <%- include('includes/sidebar', { SHOPNAME: shopName, activePage: 'dashboard' }) %>
  <div class="content">
    <%- include('includes/header', { pageTitle: 'Dashboard', user: user }) %>
    <%- include('includes/flash', { success_msg: success_msg, error_msg: error_msg }) %>

    <!-- Summary Cards -->
    <div class="row mb-4">
      <div class="col-md-3">
        <div class="card text-white bg-primary mb-3">
          <div class="card-body">
            <h5 class="card-title">کل فروخت کنندہ</h5>
            <p class="card-text fs-4"><%= totalSuppliers %></p>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card text-white bg-success mb-3">
          <div class="card-body">
            <h5 class="card-title">کل خرید کنندہ</h5>
            <p class="card-text fs-4"><%= totalCustomers %></p>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card text-white bg-warning mb-3">
          <div class="card-body">
            <h5 class="card-title">فروخت کنندہ کل رقم</h5>
           <% if(supPayable > 0) { %>
    <p class="card-text fs-4">PKR <%= supPayable.toLocaleString() %> جمع</p>
           <% } else { %>
 <p class="card-text fs-4">PKR <%= Math.abs(supPayable).toLocaleString() %> بنام</p>
        <%   } %>
          </div>
        </div>
      </div>
      <div class="col-md-3">
        <div class="card text-white bg-danger mb-3">         <div class="card-body">
            <h5 class="card-title">خرید کنندہ کل رقم</h5>
<% if(totalReceivable > 0) { %>
            <p class="card-text fs-4">PKR <%= totalReceivable.toLocaleString() %> جمع</p>
<% } else { %>
     <p class="card-text fs-4">PKR <%= Math.abs(totalReceivable).toLocaleString() %> بنام</p>
<% } %>
                  </div>
        </div>
      </div>
    </div>
 <div class="row mb-4">
    <div class="col-md-3">
    <div class="card text-white bg-danger mb-3">
    <div class="card-body">
    <h5 class="card-title">سٹاک</h5>
    <p class="card-text fs-4"><%= inventory || 0 %></p>
    </div>
    </div>
    </div>
    </div>


    <!-- Recent Transactions Table -->
  <div class="card">
  <div class="card-header">روزنامچہ</div>
  <div class="card-body">
    <div class="row">
      <!-- Customer Transactions -->
      <div class="col-md-6">
  <table class="table table-striped mb-0">
          <thead>
            <tr>
              <th>فروخت کنندہ</th>
              <th>بنام</th>
              <th>جمع</th>
            </tr>
          </thead>
          <tbody>
            <% recentSuppTransactions.forEach(Stxn => { %>
            <tr>
              <td><%= Stxn.SupplierName || '-' %></td>
              <td><%= Number(Stxn.Debit).toLocaleString() || 0 %></td>
              <td><%= Number(Stxn.Credit).toLocaleString() || 0 %></td>
            </tr>
            <% }) %>
          </tbody>
        </table>
       
      </div>

      <!-- Supplier Transactions -->
      <div class="col-md-6">
       <table class="table table-striped mb-0">
          <thead>
            <tr>
              <th>خرید کنندہ</th>
              <th>بنام</th>
              <th>جمع</th>
            </tr>
          </thead>
          <tbody>
            <% recentCustTransactions.forEach(Ctxn => { %>
            <tr>
              <td><%= Ctxn.CustomerName || '-' %></td>
              <td><%= Number(Ctxn.Debit).toLocaleString() || 0 %></td>
              <td><%= Number(Ctxn.Credit).toLocaleString() || 0 %></td>
            </tr>
            <% }) %>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>


  </div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>





